{% extends "base.html" %}

{% block title %}{% if adr %}Edit{% else %}New{% endif %} ADR - ADR-Workbench{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6">{% if adr %}Edit ADR-{{ '%04d' % adr.number }}{% else %}Create New ADR{% endif %}</h1>

<form 
    {% if adr %}
    hx-put="/api/adrs/{{ adr.id }}"
    {% else %}
    hx-post="/api/adrs"
    {% endif %}
    hx-target="#form-response"
    class="space-y-6"
    onsubmit="return ADRWorkbench.validateADRForm(this)"
>
    <div class="card">
        <label class="block mb-2 font-bold">Title</label>
        <input 
            type="text" 
            name="title" 
            value="{% if adr %}{{ adr.title }}{% endif %}"
            class="input-field" 
            required 
            placeholder="Brief description of the decision"
        >
    </div>
    
    <div class="card">
        <label class="block mb-2 font-bold">Status</label>
        <select name="status" class="input-field">
            <option value="draft" {% if not adr or adr.status == 'draft' %}selected{% endif %}>Draft</option>
            <option value="proposed" {% if adr and adr.status == 'proposed' %}selected{% endif %}>Proposed</option>
            <option value="accepted" {% if adr and adr.status == 'accepted' %}selected{% endif %}>Accepted</option>
            <option value="rejected" {% if adr and adr.status == 'rejected' %}selected{% endif %}>Rejected</option>
            <option value="deprecated" {% if adr and adr.status == 'deprecated' %}selected{% endif %}>Deprecated</option>
            <option value="superseded" {% if adr and adr.status == 'superseded' %}selected{% endif %}>Superseded</option>
        </select>
    </div>
    
    <div class="card">
        <label class="block mb-2 font-bold">Context</label>
        <textarea 
            name="context" 
            class="textarea-field" 
            required
            placeholder="What is the issue that we're trying to address? What is the context for this decision?"
        >{% if adr %}{{ adr.context }}{% endif %}</textarea>
        <p class="text-sm text-gray-500 mt-1">Describe the problem and context. Minimum 50 characters.</p>
    </div>
    
    <div class="card">
        <label class="block mb-2 font-bold">Decision</label>
        <textarea 
            name="decision" 
            class="textarea-field" 
            required
            placeholder="What decision have we made? Be specific and decisive."
        >{% if adr %}{{ adr.decision }}{% endif %}</textarea>
        <p class="text-sm text-gray-500 mt-1">State the decision clearly. Minimum 50 characters.</p>
    </div>
    
    <div class="card">
        <label class="block mb-2 font-bold">Consequences</label>
        <textarea 
            name="consequences" 
            class="textarea-field" 
            placeholder="What are the positive and negative consequences of this decision?"
        >{% if adr %}{{ adr.consequences }}{% endif %}</textarea>
        <p class="text-sm text-gray-500 mt-1">Describe both positive and negative impacts.</p>
    </div>
    
    <div class="card">
        <label class="block mb-2 font-bold">Options Considered (Optional)</label>
        <textarea 
            name="options_considered" 
            class="textarea-field" 
            placeholder="What other options were considered?"
        >{% if adr %}{{ adr.options_considered }}{% endif %}</textarea>
    </div>
    
    <div class="card">
        <label class="block mb-2 font-bold">Pros and Cons (Optional)</label>
        <textarea 
            name="pros_cons" 
            class="textarea-field" 
            placeholder="List pros and cons of the chosen approach"
        >{% if adr %}{{ adr.pros_cons }}{% endif %}</textarea>
    </div>
    
    <div class="card">
        <label class="block mb-2 font-bold">Links (Optional)</label>
        <textarea 
            name="links" 
            class="textarea-field" 
            placeholder="Related links, references, or documentation"
        >{% if adr %}{{ adr.links }}{% endif %}</textarea>
    </div>
    
    <div class="flex gap-4">
        <button type="submit" class="btn-primary">{% if adr %}Update{% else %}Create{% endif %} ADR</button>
        <a href="{% if adr %}/adrs/{{ adr.id }}{% else %}/adrs{% endif %}" class="btn-outline">Cancel</a>
        {% if not adr %}
        <button type="button" class="btn-secondary" onclick="/* Add LLM assist logic */">Use LLM Assist</button>
        {% endif %}
    </div>
    
    <div id="form-response"></div>
</form>
{% endblock %}
